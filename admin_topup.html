<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <title>Admin Panel | Point Top-up</title>
    <style>
        /* á€á€„á€·á€º website UI á€”á€²á€· á€œá€­á€¯á€€á€ºá€–á€€á€ºá€¡á€±á€¬á€„á€º CSS á€€á€­á€¯ á€•á€¼á€„á€ºá€†á€„á€ºá€•á€« */
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .admin-container { background-color: white; padding: 40px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); width: 350px; }
        h2 { text-align: center; color: #333; margin-bottom: 30px; }
        input[type="text"], input[type="number"], input[type="password"] { width: 100%; padding: 10px; margin: 8px 0 16px 0; display: inline-block; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { background-color: #007bff; color: white; padding: 14px 20px; margin: 8px 0; border: none; border-radius: 4px; cursor: pointer; width: 100%; }
        .message { text-align: center; margin-top: 10px; font-weight: bold; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <div class="admin-container">
        <h2>ğŸ”‘ Admin Point á€–á€¼á€Šá€·á€ºá€á€½á€„á€ºá€¸á€™á€¾á€¯</h2>
        
        <div id="authSection">
            <label for="adminPassword"><b>Admin Password</b></label>
            <input type="password" placeholder="Admin á€…á€€á€¬á€¸á€á€¾á€€á€ºá€‘á€Šá€·á€ºá€•á€«" id="adminPassword" required>
            <button id="authButton">á€á€„á€ºá€›á€±á€¬á€€á€ºá€™á€Šá€º</button>
            <p id="authMessage" class="message"></p>
        </div>

        <form id="topupForm" style="display:none;">
            <label for="targetUsername"><b>Username</b></label>
            <input type="text" placeholder="Point á€–á€¼á€Šá€·á€ºá€•á€±á€¸á€™á€Šá€·á€º Username" id="targetUsername" required>

            <label for="pointsAmount"><b>Point á€•á€™á€¬á€</b></label>
            <input type="number" placeholder="á€–á€¼á€Šá€·á€ºá€á€½á€„á€ºá€¸á€™á€Šá€·á€º Point á€¡á€›á€±á€¡á€á€½á€€á€º" id="pointsAmount" required min="1">
            
            <button type="submit">Point á€–á€¼á€Šá€·á€ºá€á€½á€„á€ºá€¸á€™á€Šá€º</button>
            <p id="topupMessage" class="message"></p>
        </form>
    </div>

    <script>
        // âš ï¸ á€’á€®á€”á€±á€›á€¬á€™á€¾á€¬ Admin Password á€€á€­á€¯ á€‘á€¬á€¸á€›á€¾á€­á€á€¼á€„á€ºá€¸á€€ á€œá€¯á€¶á€á€¼á€¯á€¶á€™á€¾á€¯á€™á€›á€¾á€­á€•á€« (Client-side Security)
        // á€•á€­á€¯á€™á€­á€¯á€œá€¯á€¶á€á€¼á€¯á€¶á€–á€­á€¯á€· Backend á€™á€¾á€¬ JWT á€…á€…á€ºá€†á€±á€¸á€™á€¾á€¯ á€‘á€Šá€·á€ºá€á€½á€„á€ºá€¸á€á€„á€·á€ºá€•á€«á€á€Šá€ºá‹
        const ADMIN_SECRET = "your_strong_admin_password"; // âš ï¸ á€œá€¯á€¶á€á€¼á€¯á€¶á€á€±á€¬ Password á€á€…á€ºá€á€¯á€€á€­á€¯ á€‘á€¬á€¸á€›á€¾á€­á€•á€«
        
        // âš ï¸ Worker URL á€€á€­á€¯ á€á€„á€·á€º Worker á€›á€²á€· á€œá€­á€•á€ºá€…á€¬á€”á€²á€· á€¡á€…á€¬á€¸á€‘á€­á€¯á€¸á€•á€«
        const WORKER_URL_TOPUP = 'https://shop-backend-api.yourname.workers.dev/api/admin/topup'; 

        // Authentication Logic
        document.getElementById('authButton').addEventListener('click', function() {
            const inputPass = document.getElementById('adminPassword').value;
            const authMessage = document.getElementById('authMessage');
            
            if (inputPass === ADMIN_SECRET) {
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('topupForm').style.display = 'block';
                authMessage.textContent = 'á€á€„á€ºá€›á€±á€¬á€€á€ºá€™á€¾á€¯ á€¡á€±á€¬á€„á€ºá€™á€¼á€„á€ºá€•á€«á€á€Šá€º!';
                authMessage.classList.remove('error');
                authMessage.classList.add('success');
            } else {
                authMessage.textContent = 'Password á€™á€¾á€¬á€¸á€šá€½á€„á€ºá€¸á€•á€«á€á€Šá€º';
                authMessage.classList.remove('success');
                authMessage.classList.add('error');
            }
        });

        // Top-up Logic
        document.getElementById('topupForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const targetUsername = document.getElementById('targetUsername').value;
            const pointsAmount = parseInt(document.getElementById('pointsAmount').value);
            const topupMessage = document.getElementById('topupMessage');
            const adminPass = document.getElementById('adminPassword').value; // Admin Password á€€á€­á€¯á€•á€« Backend á€€á€­á€¯ á€•á€­á€¯á€·á€™á€Šá€º

            if (pointsAmount <= 0) {
                topupMessage.textContent = 'Point á€•á€™á€¬á€á€á€Šá€º á á€‘á€€á€º á€™á€»á€¬á€¸á€›á€•á€«á€™á€Šá€º';
                topupMessage.classList.add('error');
                return;
            }

            topupMessage.textContent = 'Point á€–á€¼á€Šá€·á€ºá€á€½á€„á€ºá€¸á€”á€±á€•á€«á€á€Šá€º...';
            topupMessage.classList.remove('error', 'success');

            try {
                const response = await fetch(WORKER_URL_TOPUP, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        admin_secret: adminPass, // Worker á€€á€”á€± á€…á€…á€ºá€†á€±á€¸á€™á€Šá€º
                        username: targetUsername, 
                        points: pointsAmount 
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    topupMessage.textContent = `âœ… ${targetUsername} á€¡á€¬á€¸ ${pointsAmount} Points á€–á€¼á€Šá€·á€ºá€á€½á€„á€ºá€¸á€•á€¼á€®á€¸á€•á€«á€•á€¼á€®á‹ (á€…á€¯á€…á€¯á€•á€±á€«á€„á€ºá€¸: ${data.new_points} Points)`;
                    topupMessage.classList.add('success');
                } else {
                    topupMessage.textContent = `âŒ á€–á€¼á€Šá€·á€ºá€á€½á€„á€ºá€¸á€™á€¾á€¯ á€™á€¡á€±á€¬á€„á€ºá€™á€¼á€„á€ºá€•á€«á‹ ${data.error || 'á€¡á€™á€¾á€¬á€¸á€¡á€šá€½á€„á€ºá€¸ á€›á€¾á€­á€”á€±á€•á€«á€á€Šá€º'}`;
                    topupMessage.classList.add('error');
                }
            } catch (error) {
                topupMessage.textContent = 'Network Error: á€†á€€á€ºá€á€½á€šá€ºá á€™á€›á€•á€«';
                topupMessage.classList.add('error');
            }
        });
    </script>
</body>
</html>
