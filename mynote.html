<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KP Premium Note</title>
    <style>
        /* CSS Styles */
        :root{--bg:#0a0a1a;--card:#151528;--text:#e0e0ff;--accent:#00ff9d;--shadow:0 0 40px rgba(0,255,157,0.25);}
        *{margin:0;padding:0;box-sizing:border-box;}
        body{font-family:'Pyidaungsu',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;display:flex;flex-direction:column;line-height:1.7;}
        
        header{
            background:linear-gradient(135deg,#00ff9d,#00cc7a);
            padding:20px;
            text-align:center;
            font-size:2.2em;
            font-weight:bold;
            color:#000;
            box-shadow:0 5px 20px rgba(0,255,157,0.4);
        }
        
        main{
            flex:1;
            padding:20px;
            display:flex;
            flex-direction:column;
            align-items:center;
            gap:25px;
            max-width:1000px;
            margin:auto;
            width:100%;
        }
        
        #note{
            width:100%;
            min-height:65vh;
            padding:30px;
            font-size:1.35em;
            background:var(--card);
            border:3px solid var(--accent);
            border-radius:25px;
            box-shadow:var(--shadow);
            transition:all 0.4s;
            overflow:auto; 
            white-space: pre-wrap; /* Newline á€™á€»á€¬á€¸á€€á€­á€¯ á€–á€±á€¬á€ºá€•á€¼á€›á€”á€º */
        }
        
        .pw-box{
            width:100%;
            max-width:800px;
            background:var(--card);
            padding:30px;
            border-radius:25px;
            border:2px solid #333;
            text-align:center;
            box-shadow:var(--shadow);
        }
        
        #textAdminPanel input[type="text"] {
            width:100%;
            padding:18px;
            font-size:1.3em;
            background:#222;
            color:white;
            border:none;
            border-radius:15px; 
            text-align:left;
            margin-bottom:15px;
        }

        input[type="password"] {
            width:100%;
            padding:18px;
            font-size:1.3em;
            background:#222;
            color:white;
            border:none;
            border-radius:50px;
            text-align:center;
            margin-bottom:15px;
        }
        button{
            width:100%;
            padding:18px;
            background:var(--accent);
            color:#000;
            border:none;
            border-radius:50px;
            font-size:1.3em;
            font-weight:bold;
            cursor:pointer;
            transition:0.3s;
        }
        button:hover{transform:scale(1.05);box-shadow:0 10px 30px rgba(0,255,157,0.5);}
        
        footer{
            padding:20px;
            text-align:center;
            color:#666;
            font-size:0.95em;
            background:rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <header>ğŸ¤“KP Premium Social Accounts & NotesğŸ¤“</header>
    
    <main>
        <div id="note" contenteditable="false">
            Note á€™á€»á€¬á€¸á€€á€­á€¯ Cloud á€™á€¾ á€›á€šá€°á€”á€±á€•á€«á€á€Šá€ºá‹...
        </div>

        <div class="pw-box" id="adminPasswordGate" style="max-width: 420px;">
            <input type="password" id="pass" placeholder="á€…á€€á€¬á€¸á€á€¾á€€á€ºá€›á€­á€¯á€€á€ºá€•á€«">
            <button onclick="unlock()">á€•á€¼á€„á€ºá€†á€„á€ºá€–á€½á€„á€·á€ºá€™á€šá€º</button>
        </div>

        <div id="textAdminPanel" class="pw-box" style="display:none;">
            <input type="text" id="inputLine" placeholder="á€…á€¬á€¡á€á€…á€ºá€›á€­á€¯á€€á€ºá€‘á€Šá€·á€ºá€•á€«..." style="margin-bottom: 15px;"/>
            <button onclick="saveNote()" id="saveButton">Save á€œá€¯á€•á€ºá€™á€Šá€º</button>
        </div>
    </main>

    <footer>Â© KP â€¢ á€œá€°á€á€­á€¯á€„á€ºá€¸á€™á€¼á€„á€ºá€› â€¢ á€„á€«á€á€…á€ºá€šá€±á€¬á€€á€ºá€•á€² á€•á€¼á€„á€ºá€›</footer>

    <script>
        const note = document.getElementById("note");
        const correctPass = "232003"; // á€á€„á€·á€º Admin Password
        
        // ğŸ’¡ğŸ’¡ğŸ’¡ Relative API Path á€–á€¼á€„á€·á€º á€•á€¼á€„á€ºá€†á€„á€ºá€‘á€¬á€¸á€á€Šá€º ğŸ’¡ğŸ’¡ğŸ’¡
        // á€á€„á€ºá Cloudflare Worker á€€á€­á€¯ /mynote route á€á€½á€„á€º á€á€»á€­á€á€ºá€‘á€¬á€¸á€á€Šá€ºá€Ÿá€¯ á€šá€°á€†á€á€Šá€ºá‹
        const NOTE_API_PATH = "/mynote"; 
        
        // --- GET: Worker á€™á€¾ Note á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸á€€á€­á€¯ á€›á€šá€°á€á€¼á€„á€ºá€¸ ---
        async function fetchNote() {
            try {
                const res = await fetch(NOTE_API_PATH + "?t=" + Date.now()); 
                note.innerHTML = await res.text();
            } catch(e) {
                note.innerHTML = "á€¡á€„á€ºá€á€¬á€”á€€á€ºá€™á€›á€¾á€­á€•á€« / Worker URL á€…á€…á€ºá€•á€«"; 
            }
        }

        // --- POST: á€…á€¬á€á€„á€ºá€á€²á€·á€¡á€•á€­á€¯á€„á€ºá€¸ (Timestamp & Prepend Logic) ---
        async function saveNote() {
            const inputLine = document.getElementById('inputLine');
            const saveButton = document.getElementById('saveButton');
            
            const newText = inputLine.value.trim();
            if (!newText) {
                alert('á€…á€¬á€¡á€á€…á€ºá€›á€­á€¯á€€á€ºá€‘á€Šá€·á€ºá€›á€”á€º á€œá€­á€¯á€¡á€•á€ºá€•á€«á€á€Šá€ºá‹'); 
                return;
            }

            // á€™á€¼á€”á€ºá€™á€¬á€…á€¶á€”á€¾á€¯á€”á€ºá€¸á€”á€²á€· Timestamp á€‘á€¯á€á€ºá€œá€¯á€•á€ºá€á€¼á€„á€ºá€¸
            const timestamp = new Date().toLocaleString('my-MM', {
                year: 'numeric', month: 'numeric', day: 'numeric',
                hour: '2-digit', minute: '2-digit', second: '2-digit',
                hour12: false
            });
            
            const divider = '\n\n============================\n\n'; 
            
            let oldContent = note.innerHTML.trim();
            
            // Placeholder á€™á€»á€¬á€¸á€€á€­á€¯ á€›á€¾á€„á€ºá€¸á€œá€„á€ºá€¸á€á€¼á€„á€ºá€¸
            if (oldContent.includes('á€›á€šá€°á€”á€±á€•á€«á€á€Šá€º') || oldContent.includes('Error') || oldContent.includes('á€¡á€„á€ºá€á€¬á€”á€€á€ºá€™á€›á€¾á€­á€•á€«')) {
                oldContent = '';
            }

            // á€…á€¬á€¡á€á€…á€ºá€€á€­á€¯ á€¡á€•á€±á€«á€ºá€†á€¯á€¶á€¸á€á€½á€„á€º á€•á€±á€«á€„á€ºá€¸á€‘á€Šá€·á€ºá€á€¼á€„á€ºá€¸
            const newEntry = `[${timestamp}]\n\n${newText}`;
            let updated = (oldContent === '') ? newEntry : newEntry + divider + oldContent;

            saveButton.disabled = true;
            saveButton.innerText = 'á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€”á€±á€•á€«á€á€Šá€º...';
            
            try {
                // Worker á€á€­á€¯á€· POST á€œá€¯á€•á€ºá€á€Šá€ºá‹
                const res = await fetch(NOTE_API_PATH, {
                    method: 'POST', 
                    body: updated, 
                    headers: {'Content-Type': 'text/plain'}
                });
                
                if (!res.ok) throw new Error(res.statusText || 'Server Error');

                note.innerHTML = updated; // UI Update
                inputLine.value = ''; // Input Clear
                note.scrollTop = 0; // Scroll to top
                alert('âœ… á€¡á€±á€¬á€„á€ºá€™á€¼á€„á€ºá€…á€½á€¬ á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€•á€¼á€®á€¸á€•á€«á€•á€¼á€®!');

            } catch (e) {
                alert('âŒ á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€™á€¾á€¯ á€™á€¡á€±á€¬á€„á€ºá€™á€¼á€„á€ºá€•á€«á‹ Error: ' + e.message);
            } finally {
                saveButton.disabled = false;
                saveButton.innerText = 'Save á€œá€¯á€•á€ºá€™á€Šá€º';
            }
        }

        // --- á€…á€€á€¬á€¸á€á€¾á€€á€º á€…á€…á€ºá€†á€±á€¸á€á€¼á€„á€ºá€¸ ---
        function unlock(){
            if(document.getElementById("pass").value === correctPass){
                document.getElementById('adminPasswordGate').style.display = 'none'; 
                document.getElementById('textAdminPanel').style.display = 'block'; 
                note.contentEditable = false;
            } else {
                alert("á€…á€€á€¬á€¸á€á€¾á€€á€º á€™á€¾á€¬á€¸á€á€šá€º á€€á€½á€¬ ğŸ˜›");
            }
        }

        // --- Initialization ---
        fetchNote();
        setInterval(fetchNote, 10000); // áá€ á€…á€€á€¹á€€á€”á€·á€ºá€á€…á€ºá€á€« Note á€€á€­á€¯ á€•á€¼á€”á€ºá€†á€½á€²á€á€Šá€ºá‹
    </script>
</body>
</html>
